# 需求文档

## 简介

食物热量扫描器是一个移动端网页应用，允许用户通过手机摄像头拍摄食物照片，自动识别食物并返回热量信息和健康建议。该应用面向关注饮食健康的用户，提供快速便捷的食物热量查询功能。

## 术语表

- **系统（System）**：食物热量扫描器网页应用
- **用户（User）**：使用手机浏览器访问应用的终端用户
- **摄像头接口（Camera_Interface）**：调用手机摄像头的浏览器API接口
- **图片上传模块（Image_Upload_Module）**：处理图片上传到服务器的模块
- **识别服务（Recognition_Service）**：调用OpenAI Vision API进行食物识别的后端服务
- **结果展示模块（Result_Display_Module）**：在页面上展示识别结果的前端模块

## 需求

### 需求 1：移动端网页访问

**用户故事：** 作为用户，我希望能够直接在手机浏览器中打开应用，这样我就可以随时随地使用该功能而无需安装额外的应用程序。

#### 验收标准

1. 当用户在手机浏览器中访问应用URL时，系统应当加载并显示完整的应用界面
2. 当页面加载时，系统应当自动适配不同尺寸的手机屏幕
3. 当用户使用常见移动浏览器（Chrome、Safari、Firefox）时，系统应当正常运行所有功能
4. 当页面加载完成时，系统应当在3秒内显示可交互的界面

### 需求 2：摄像头调用功能

**用户故事：** 作为用户，我希望能够通过点击按钮调用手机摄像头拍照，这样我就可以快速捕捉食物图片。

#### 验收标准

1. 当用户点击拍照按钮时，系统应当请求摄像头访问权限
2. 当用户授予摄像头权限时，系统应当打开手机的后置摄像头
3. 当摄像头打开时，系统应当显示实时预览画面
4. 当用户拍摄照片时，系统应当捕获当前画面并生成图片文件
5. 如果用户拒绝摄像头权限，则系统应当显示友好的错误提示信息

### 需求 3：图片自动上传

**用户故事：** 作为用户，我希望拍照后图片能够自动上传，这样我就不需要手动操作额外的上传步骤。

#### 验收标准

1. 当照片拍摄完成时，系统应当立即开始上传图片到服务器
2. 当图片上传过程中时，系统应当显示上传进度指示器
3. 当图片上传成功时，系统应当触发食物识别流程
4. 如果图片上传失败，则系统应当显示错误信息并提供重试选项
5. 当图片大于5MB时，系统应当在上传前自动压缩图片

### 需求 4：食物识别功能

**用户故事：** 作为用户，我希望系统能够自动识别照片中的食物，这样我就可以获得准确的食物信息。

#### 验收标准

1. 当图片上传成功时，系统应当调用OpenAI Vision API进行食物识别
2. 当API调用时，系统应当发送清晰的提示词要求识别食物类型
3. 当识别完成时，系统应当解析API返回的食物名称信息
4. 如果API调用失败，则系统应当返回错误信息并记录日志
5. 当识别超时（超过30秒）时，系统应当终止请求并提示用户重试

### 需求 5：热量和健康建议展示

**用户故事：** 作为用户，我希望看到食物的热量信息和健康建议，这样我就可以做出更好的饮食选择。

#### 验收标准

1. 当食物识别完成时，系统应当显示食物名称
2. 当显示结果时，系统应当包含估算的热量值（以kcal为单位）
3. 当显示结果时，系统应当提供简短的健康建议（不超过100字）
4. 当显示结果时，系统应当使用清晰易读的字体和布局
5. 当用户查看结果后时，系统应当提供"重新拍照"按钮以开始新的识别

### 需求 6：用户界面设计

**用户故事：** 作为用户，我希望界面简洁直观，这样我就可以轻松使用所有功能。

#### 验收标准

1. 系统应当使用简洁的单页面布局
2. 当页面显示时，系统应当使用大号、易于点击的按钮（最小44x44像素）
3. 当显示文字时，系统应当使用至少16px的字体大小以确保可读性
4. 系统应当使用高对比度的颜色方案以提高可见性
5. 当用户操作时，系统应当提供即时的视觉反馈（如按钮点击效果）

### 需求 7：错误处理

**用户故事：** 作为用户，我希望在出现问题时能够看到清晰的错误提示，这样我就知道如何解决问题。

#### 验收标准

1. 当发生错误时，系统应当显示用户友好的中文错误消息
2. 当网络连接失败时，系统应当提示用户检查网络连接
3. 当摄像头不可用时，系统应当说明可能的原因和解决方法
4. 当API调用失败时，系统应当提供重试选项
5. 如果图片中未识别到食物，则系统应当提示用户重新拍摄更清晰的照片

### 需求 8：后端API接口

**用户故事：** 作为系统，我需要一个后端API来处理图片上传和OpenAI调用，这样前端就可以实现完整的功能流程。

#### 验收标准

1. 系统应当提供POST接口接收图片文件上传
2. 当接收到图片时，系统应当验证图片格式（支持JPEG、PNG、WebP）
3. 当图片验证通过时，系统应当调用OpenAI Vision API进行分析
4. 当API返回结果时，系统应当解析并格式化为标准JSON响应
5. 系统应当实现API密钥的安全存储，不暴露给前端

### 需求 9：性能要求

**用户故事：** 作为用户，我希望应用响应迅速，这样我就可以快速获得结果。

#### 验收标准

1. 当页面首次加载时，系统应当在3秒内完成渲染
2. 当用户点击拍照按钮时，系统应当在1秒内打开摄像头
3. 当图片上传时，系统应当在5秒内完成上传（在正常网络条件下）
4. 当调用OpenAI API时，系统应当在15秒内返回识别结果
5. 系统应当优化图片大小，确保上传文件不超过2MB

### 需求 10：浏览器兼容性

**用户故事：** 作为用户，我希望应用能在我的手机浏览器上正常工作，无论我使用什么品牌的手机。

#### 验收标准

1. 系统应当支持iOS Safari 14及以上版本
2. 系统应当支持Android Chrome 90及以上版本
3. 系统应当支持Android Firefox 90及以上版本
4. 当浏览器不支持摄像头API时，系统应当显示不兼容提示
5. 系统应当使用标准的Web API，避免使用浏览器特定的功能
